<!DOCTYPE html>
<html  lang="zh_CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

      <title>常用工具介绍</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <!-- bundled in js (rollup iife) -->
      <!-- <link rel="stylesheet" href="../_static/theme.css"> -->
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/css/theme.css " type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../_static/theme-vendors.js"></script> -->
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="索引" href="../genindex.html" />
  <link rel="search" title="搜索" href="../search.html" />
  <link rel="next" title="开发手册" href="../source_doc/j5_ddk_docs.html" />
  <link rel="prev" title="系统镜像升级" href="j5_dev_board_system_image.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">地平线J5芯片开发手册</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="https://horizon.ai/"
        class="nav-link external">
          地平线官网 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://developer.horizon.ai/"
        class="nav-link external">
          社区问题求助 <outboundlink></outboundlink>
      </a>
    </div>
  
    <div class="nav-item">
      <a href="https://wenjuan.feishu.cn/m?t=srSlsnSEmgsi-ambr"
        class="nav-link external">
          产品使用反馈 <outboundlink></outboundlink>
      </a>
    </div>
  

            
          </navlinks><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#j5">概述</a></span>
      </p>
      <ul class="">
        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#j5">芯片介绍</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="j5_board_overview.html" class="reference internal ">关于征程5代芯片</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#j5">系统镜像</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="j5_dev_board_system_image.html" class="reference internal ">系统镜像升级</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">常用工具介绍</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#id2" class="reference internal">1. 采集/设置系统信息的工具集</a></li>
                
                  <li class="toctree-l2"><a href="#log" class="reference internal">2. Log系统使用</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="../source_doc/j5_ddk_docs.html" class="reference internal ">开发手册</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../source_doc/j5_oe_detail.html" class="reference internal ">附录：发布物内容</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>常用工具介绍</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="j5_dev_board_system_image.html"
       title="上一章">← 系统镜像升级</a>
  </li>
  <li class="next">
    <a href="../source_doc/j5_ddk_docs.html"
       title="下一章">开发手册 →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="id1">
<h1>常用工具介绍<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<section id="id2">
<h2>1. 采集/设置系统信息的工具集<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<section id="bpu-hrut-bpuprofile">
<h3>1.1 BPU状态设置工具 <code class="docutils literal notranslate"><span class="pre">hrut_bpuprofile</span></code><a class="headerlink" href="#bpu-hrut-bpuprofile" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hrut_bpuprofile</span></code> 工具可用来调频、开关BPU电源、开关BPU时钟、查看BPU使用率、获取function call（fc）时间等。
其参数介绍如下：</p>
<section id="id3">
<h4>1.1.1 参数说明<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h4>
<dl class="option-list">
<dt><kbd><span class="option">-b</span></kbd></dt>
<dd><p>用于设置所使用的BPU核：<code class="docutils literal notranslate"><span class="pre">0</span></code> 为BPU0；<code class="docutils literal notranslate"><span class="pre">1</span></code> 为BPU1；<code class="docutils literal notranslate"><span class="pre">2</span></code> 为all。</p>
</dd>
<dt><kbd><span class="option">-p</span></kbd></dt>
<dd><p>用于设置电源掉电/上电，<code class="docutils literal notranslate"><span class="pre">0</span></code> 为OFF，<code class="docutils literal notranslate"><span class="pre">1</span></code> 为ON。</p>
</dd>
<dt><kbd><span class="option">-c</span></kbd></dt>
<dd><p>用于设置时钟（CLOCK） ON/OFF, <code class="docutils literal notranslate"><span class="pre">0</span></code> 为OFF；<code class="docutils literal notranslate"><span class="pre">1</span></code> 为ON。</p>
</dd>
<dt><kbd><span class="option">-f</span></kbd></dt>
<dd><p>用于设置BPU频率。 比如： <code class="docutils literal notranslate"><span class="pre">n</span></code> 为设置BPU频率为n。</p>
</dd>
<dt><kbd><span class="option">-r</span></kbd></dt>
<dd><p>查看BPU使用率，比如： <code class="docutils literal notranslate"><span class="pre">n</span></code> 为查看n次，<code class="docutils literal notranslate"><span class="pre">0</span></code> 为时钟查看。</p>
</dd>
<dt><kbd><span class="option">-e</span></kbd></dt>
<dd><p>使能查看fc执行时间功能（这是一个兼容参数，J5默认已开启且无法关闭）。</p>
</dd>
<dt><kbd><span class="option">-t</span></kbd></dt>
<dd><p>查看前50次每个fc的执行时间。</p>
</dd>
<dt><kbd><span class="option">-h</span></kbd></dt>
<dd><p>帮助信息。</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>1.1.2 功能示例<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h4>
<p><strong>功能示例1：查看BPU使用率</strong></p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">0</span> –r <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，查看BPU Core0的使用率。 <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">1</span></code> 代表只执行一次； <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">n</span></code> 代表执行n次，间隔1s。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> –r <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，查看BPU Core1的使用率。 <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">1</span></code> 代表只执行一次； <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">n</span></code> 代表执行n次，间隔1s。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">2</span> –r <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，同时查看BPU Core0和Core1的使用率。 <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">1</span></code> 代表只执行一次； <code class="docutils literal notranslate"><span class="pre">-r</span> <span class="pre">n</span></code> 代表执行n次，间隔1s。</p>
</div></blockquote>
<p><strong>功能示例2：设置BPU的频率</strong></p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">0</span> -f <span class="m">400000000</span>
</pre></div>
</div>
<p>如上所示，设置BPU0的频率为400M。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat /sys/devices/system/bpu/bpu0/devfreq/devfreq*/available_frequencies
</pre></div>
</div>
<p>如上所示，查看BPU0支持的频率设置。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat /sys/devices/system/bpu/bpu0/devfreq/devfreq*/cur_freq
</pre></div>
</div>
<p>如上所示，查看BPU0频率设置是否设置。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> -f <span class="m">400000000</span>
</pre></div>
</div>
<p>如上所示，设置BPU1的频率为400M。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat /sys/devices/system/bpu/bpu1/devfreq/devfreq*/available_frequencies
</pre></div>
</div>
<p>如上所示，查看BPU1支持哪些频率。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat /sys/devices/system/bpu/bpu1/devfreq/devfreq*/cur_freq
</pre></div>
</div>
<p>如上所示，查看BPU1频率设置是否成功。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">2</span> –f <span class="m">400000000</span>
</pre></div>
</div>
<p>如上所示，设置BPU0/BPU1的频率为400M。</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>BPU core支持频率的查看方法同上。</p>
</div>
</div></blockquote>
<p><strong>功能示例3：给BPU上/下电</strong></p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">0</span> –p <span class="m">0</span>
</pre></div>
</div>
<p>如上所示，将BPU Core 0下电。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">0</span> –p <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，将BPU Core 0上电。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> –p <span class="m">0</span>
</pre></div>
</div>
<p>如上所示，将BPU Core 1下电。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> –p <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，将BPU Core 1上电。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">2</span> –p <span class="m">0</span>
</pre></div>
</div>
<p>如上所示，同时将BPU Core 0/1下电。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> –p <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，同时将BPU Core 0/1上电。</p>
</div></blockquote>
<p><strong>功能示例4：查看Functional Call执行时间</strong></p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">0</span> -t <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，显示BPU Core0最近已处理fc任务的执行时间信息。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_bpuprofile -b <span class="m">1</span> -t <span class="m">1</span>
</pre></div>
</div>
<p>如上所示，显示BPU Core1最近已处理fc任务的执行时间信息。</p>
<p>输出信息如下：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@j5fpgaj5-hynix1G-3200:~# hrut_bpuprofile -b <span class="m">1</span> -t <span class="m">1</span>
index   id:hwid         group   prio    s_time  e_time  r_time
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:3764  <span class="m">0</span>       <span class="m">62921677</span>        <span class="m">62921682</span>        4105us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:3796  <span class="m">0</span>       <span class="m">62933366</span>        <span class="m">62933370</span>        4144us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4035  <span class="m">0</span>       <span class="m">68487608</span>        <span class="m">68487612</span>        4121us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4068  <span class="m">0</span>       <span class="m">68499410</span>        <span class="m">68499414</span>        4137us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4511  <span class="m">0</span>       <span class="m">79866092</span>        <span class="m">79866096</span>        4119us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4543  <span class="m">0</span>       <span class="m">79878146</span>        <span class="m">79878150</span>        4108us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4709  <span class="m">0</span>       <span class="m">83453803</span>        <span class="m">83453807</span>        4133us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:4741  <span class="m">0</span>       <span class="m">83469283</span>        <span class="m">83469287</span>        4152us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:5139  <span class="m">0</span>       <span class="m">93023013</span>        <span class="m">93023018</span>        4120us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:5171  <span class="m">0</span>       <span class="m">93035083</span>        <span class="m">93035087</span>        4103us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14375 <span class="m">0</span>       <span class="m">351997119</span>       <span class="m">351997123</span>       4139us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14407 <span class="m">0</span>       <span class="m">352006717</span>       <span class="m">352006721</span>       4125us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14439 <span class="m">0</span>       <span class="m">352024763</span>       <span class="m">352024785</span>       21391us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14491 <span class="m">0</span>       <span class="m">352232178</span>       <span class="m">352232182</span>       4133us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14523 <span class="m">0</span>       <span class="m">352241687</span>       <span class="m">352241691</span>       4126us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14555 <span class="m">0</span>       <span class="m">352259848</span>       <span class="m">352259869</span>       21399us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14672 <span class="m">0</span>       <span class="m">352988487</span>       <span class="m">352988491</span>       4124us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14704 <span class="m">0</span>       <span class="m">353001178</span>       <span class="m">353001182</span>       4133us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14769 <span class="m">0</span>       <span class="m">353075527</span>       <span class="m">353075531</span>       4111us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14801 <span class="m">0</span>       <span class="m">353087887</span>       <span class="m">353087891</span>       4114us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14865 <span class="m">0</span>       <span class="m">353319642</span>       <span class="m">353319646</span>       4121us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14898 <span class="m">0</span>       <span class="m">353332211</span>       <span class="m">353332215</span>       4120us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:14981 <span class="m">0</span>       <span class="m">353513195</span>       <span class="m">353513199</span>       4126us
<span class="m">1</span>       <span class="m">1</span>:1     <span class="m">0</span>:15013 <span class="m">0</span>       <span class="m">353525904</span>       <span class="m">353525908</span>       4116us
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code>：该任务位于BPU硬件FIFO中的位置；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code>：用户设置的中断ID；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hwid</span></code>：底层驱动维护的中断ID；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code>：用户设置的组ID，用户进程号；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prio</span></code>：任务优先级；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s_time</span></code>：任务处理开始的时间戳；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e_time</span></code>：任务处理结束的时间戳；</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_time</span></code>：任务被处理的总耗时。</p></li>
</ul>
</div>
</div></blockquote>
</section>
</section>
<section id="mac-hrut-mac-utility">
<h3>1.2 开发板网卡MAC设置工具 <code class="docutils literal notranslate"><span class="pre">hrut_mac</span> <span class="pre">utility</span></code><a class="headerlink" href="#mac-hrut-mac-utility" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hrut_mac</span> <span class="pre">utility</span></code> 工具用来保存当前板子网卡MAC相关参数的utility。</p>
<p><strong>写入：</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_mac s aa:bb:cc:dd:ee:ff
</pre></div>
</div>
<p><strong>读出：</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_mac g
</pre></div>
</div>
</section>
<section id="ip-hrut-ipfull">
<h3>1.3 开发板IP设置工具 <code class="docutils literal notranslate"><span class="pre">hrut_ipfull</span></code><a class="headerlink" href="#ip-hrut-ipfull" title="永久链接至标题">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">hrut_ipfull</span></code> 是用来保存当前板子IP相关参数的工具。
IP配置完成后，板子下次上电会自动配置网络参数（IP&amp;MASK）并添加网关（GATEWAY）到路由。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>部分产品IP被锁死，无法通过本工具进行配置。</p>
</div>
<section id="id5">
<h4>1.3.1 写入<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_ipfull s <span class="o">{</span>IP<span class="o">}</span> <span class="o">{</span>MASK<span class="o">}</span> <span class="o">{</span>GATEWAY<span class="o">}</span>
</pre></div>
</div>
<p>参考示例：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_ipfull s <span class="m">192</span>.168.1.10 <span class="m">255</span>.255.255.0 <span class="m">192</span>.168.1.255
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>配置成功后，将在下一次启动生效。</p>
</div>
</section>
<section id="id6">
<h4>1.3.2 读出<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_ipfull g
</pre></div>
</div>
<p>参考输出如下：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">ip</span><span class="o">=</span><span class="m">192</span>.168.1.10
<span class="nv">mask</span><span class="o">=</span><span class="m">255</span>.255.255.0
<span class="nv">gw</span><span class="o">=</span><span class="m">192</span>.168.1.255
</pre></div>
</div>
</section>
<section id="id7">
<h4>1.3.3 清除<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hrut_ipfull c
</pre></div>
</div>
<p>一旦清除后，板子下次上电会使用默认地址 <code class="docutils literal notranslate"><span class="pre">192.168.1.10</span></code>。</p>
<div class="admonition attention">
<p class="admonition-title">注意</p>
<p>一旦配置成功，重启后在 <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> 下面会有几个文件，记录了当前的配置的值，其含义如名字：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/tmp/ip_mac</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/tmp/ip_ip</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/tmp/ip_mask</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/tmp/ip_gw</span></code></p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="log">
<h2>2. Log系统使用<a class="headerlink" href="#log" title="永久链接至标题">¶</a></h2>
<p>J5系统软件支持自动抓取LOG到 <code class="docutils literal notranslate"><span class="pre">/userdata/log</span></code> 分区中，具体LOG内容如下表所示：</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 30%" />
<col style="width: 51%" />
<col style="width: 19%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>存储位置</strong></p></td>
<td><p><strong>存储内容说明</strong></p></td>
<td><p><strong>附加说明</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/kernel/message</span></code></p></td>
<td><p>kernel log。 <code class="docutils literal notranslate"><span class="pre">/etc/syslog-startup.conf</span></code> 中可修改： <code class="docutils literal notranslate"><span class="pre">LOGFILE</span></code>、 <code class="docutils literal notranslate"><span class="pre">ROTATESIZE</span></code> 和 <code class="docutils literal notranslate"><span class="pre">ROTATEGENS</span></code>。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LOGFILE</span></code>：log存储路径。</p>
<p><code class="docutils literal notranslate"><span class="pre">ROTATESIZE</span></code>：log文件大小。</p>
<p><code class="docutils literal notranslate"><span class="pre">ROTATEGENS</span></code>：log文件个数。</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/kern.$YmdHMS/$LOGTIME.kmsg</span></code></p></td>
<td><p>检查kernel log文件。如果大小达到 <code class="docutils literal notranslate"><span class="pre">ROTATESIZE</span></code> 则转存为 <code class="docutils literal notranslate"><span class="pre">$LOGTIME.kmsg</span></code>。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">YmdHMS</span></code>：文件夹记录时间。</p>
<p><code class="docutils literal notranslate"><span class="pre">LOGTIME</span></code>：日志记录日志。</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/kern.$YmdHMS.tar.gz</span></code></p></td>
<td><p>检查 <code class="docutils literal notranslate"><span class="pre">*.kmsg</span></code> 文件个数。如果个数达到 <code class="docutils literal notranslate"><span class="pre">ROTATEGENS</span></code> 则压缩为 <code class="docutils literal notranslate"><span class="pre">kern.$YmdHMS.tar.gz</span></code>。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">YmdHMS</span></code>：压缩包存储时间。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/user/message</span></code></p></td>
<td><p>使用 <code class="docutils literal notranslate"><span class="pre">logcat</span> <span class="pre">-v</span> <span class="pre">time</span> <span class="pre">-f</span> <span class="pre">/userdata/log/user/message</span> <span class="pre">-r</span> <span class="pre">[filesize]</span> <span class="pre">-n</span> <span class="pre">[filecount]</span></code> 抓取userspace log。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filesize</span></code>：log文件大小。</p>
<p><code class="docutils literal notranslate"><span class="pre">filecount</span></code>：log文件个数。</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/user.$YmdHMS/$LOGTIME.umsg</span></code></p></td>
<td><p>检查userspace log文件。如果大小达到 <code class="docutils literal notranslate"><span class="pre">filesize</span></code> 则转存为 <code class="docutils literal notranslate"><span class="pre">$LOGTIME.umsg</span></code>。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filesize</span></code>：log文件大小。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/user.$YmdHMS.tar.gz</span></code></p></td>
<td><p>检查 <code class="docutils literal notranslate"><span class="pre">*.umsg</span></code> 文件个数。如果个数达到 <code class="docutils literal notranslate"><span class="pre">filecount</span></code> 则压缩为 <code class="docutils literal notranslate"><span class="pre">user.$YmdHMS.tar.gz</span></code>。</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">filecount</span></code>：log文件个数。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/reset_reason.txt</span></code></p></td>
<td><p>记录每次重启时间和原因，通过命令行中的 <code class="docutils literal notranslate"><span class="pre">hobotboot.reason</span></code> 传递给kernel和userspace。</p>
<p>在logstore-daemon启动时写入到 <code class="docutils literal notranslate"><span class="pre">reset_reason.txt</span></code>。</p>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/pstore/${PSTORE_LOGINDEX}.${PSTORE_LOGDATE}/*</span></code></p></td>
<td><p>记录内核异常时的log信息。</p>
<p><code class="docutils literal notranslate"><span class="pre">/etc/rcS.d/S40pstore-log.sh</span></code> 中可修改文件存储路径（<code class="docutils literal notranslate"><span class="pre">PSTORE_LOG</span></code>）和个数（<code class="docutils literal notranslate"><span class="pre">PSTORE_LOGMAX</span></code>）。</p>
</td>
<td><p><code class="docutils literal notranslate"><span class="pre">PSTORE_LOGINDEX</span></code>：pstore日志索引数。</p>
<p><code class="docutils literal notranslate"><span class="pre">PSTORE_LOGDATE</span></code>：</p>
<p><code class="docutils literal notranslate"><span class="pre">pstore</span></code> 日志记录时间：</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">/userdata/log/coredump/</span></code></p></td>
<td><p>记录程序出错而异常中断时的工作状态。 <code class="docutils literal notranslate"><span class="pre">/etc/sysctl.conf</span></code> 中可修改文件存储位置（<code class="docutils literal notranslate"><span class="pre">kernel.core_pattern</span></code>）。</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="j5_dev_board_system_image.html"
       title="上一章">← 系统镜像升级</a>
  </li>
  <li class="next">
    <a href="../source_doc/j5_ddk_docs.html"
       title="下一章">开发手册 →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; 版权所有 2022, Horizon Robotics.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>